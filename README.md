# MalwareClassification

## Description

Every malware file were converted to PNG images and used them as input for CNN. Model will give the probability of the input images corresponding to the classes. From that will be classified what class does the original image belong to?

## Dataset

From paper: Lakshmanan Nataraj, Sreejith Karthikeyan, Gregoire Jacob, and Bangalore S Man-
junath. Malware images: visualization and automatic classification. In Proceedings of the 8th international symposium on visualization for cyber security, pages 1â€“7, 2011.[](https://dl.acm.org/doi/abs/10.1145/2016904.2016908).

![dataset](https://github.com/hoangdh1/MalwareClassification/blob/main/images/data.png?raw:true)

The Malimg dataset contains 9339 Malware images, belong to 25 classes.

![distribute_data](https://github.com/hoangdh1/MalwareClassification/blob/main/images/distribute_data.png?raw:true)

## Model

After building the initial model and optimizing the model we get the model with the following architecture:

- Convolutional layer: 50 filters, kernel size (5 * 5), activation ReLU
- LayerNormalization layer
- Max pooling layer: pool size (2 * 2)
- Convolutional layer: 70 filters, kernel size (3 * 3), activation ReLU
- LayerNormalization layer
- Max pooling layer: pool size (2 * 2)
- Convolutional layer: 70 filters, kernel size (3 * 3), activation ReLU
- LayerNormalization layer
- Max pooling layer: pool size (2 * 2)
- Flatten layer
- Dense/Fully connected layer: 256 neurons, activation ReLU
- Dense/Fully connected layer : num_class neurons (25), activation Softmax

with the loss function optimization algorithm Adam and the learning rate equal to 0.001.

## Evaluation

Because there is an imbalance between classes, to evaluate the effectiveness of the model we use
Stratifield Sampling method. In addition, because the amount of data is not much, we
will combine with K-fold Cross-validation for evaluation.

- Accuracy 97.21%
- Precision 94.76%
- Recall 93.48%
- F1-score 93.87%

